let topTitleDiv = "<h4>Storytelling with Maps</h4>";

let titleDiv =
  "<h1>Flushing at a Crossroads: Community vs. Gentrification</h1>";

let bylineDiv = '<p style="font-size:1.3em; margin:3em auto;">By Josie & Shuxian</p>';

let descriptionDiv =
  '<p style="margin:2em auto 2em auto;">Flushing is experiencing a wave of gentrification and displacement. Wealthy Asian immigrants and wealthy local Asian residents are displacing poor Asian immigrants.</p>' +
  '<p style="margin:2em auto 2em auto;">The influx of transnational capital and rise of luxury developments in Flushing has displaced longtime immigrant residents and small business owners.</p>' +
  '<p style="margin:2em auto 2em auto; text-align:center;">Scroll to continue<br>▼</p>';

let footerDiv =
  '<p>This story is based on data by the <a href="https://a816-health.nyc.gov/ABCEatsRestaurants/#!/Search">NYC Department of Health and Mental Hygiene</a> and reporting by the <a href="https://www.theguardian.com/us-news/2020/aug/13/flushing-queens-gentrification-luxury-developments">The Guardian</a>, <a href="https://storymaps.arcgis.com/stories/4b827a95ba3346c7956ae4f4b86e9b48">ArcGIS StoryMaps</a>, and <a href="https://www.nytimes.com/2023/06/21/arts/design/mini-mall-flushing-art-asia.html?searchResultPosition=5">New York Times</a>.</p>' +
  '<p><a href="https://www.mapbox.com/about/maps/" target="_blank">© Mapbox</a> | <a href="http://www.openstreetmap.org/about/" target="_blank">© OpenStreetMap</a></p>';

let divText0 =
  "<p>Flushing is one of the two chinatown in New York City.</p>";

let divText1 =
  "<p>The most significant change to Flushing is the disruption of its <span class='highlightgrey'>food scene</span>.</p>";

let divText2 =
  "<p>In Queens, there are a large number of <span class='highlightblack'>Chinese Small Business Restaurants</span>, the majority of which are clustered in downtown Flushing.</p>";

let divText3 =
  "<p>In recent years, the number of food and drink retail stores has grown markedly. But many of the additions are <span class='highlightred'>High-end Venues</span>. </p>";

let divText4 =
  "<p>The increase in fancy restaurants has negatively affected Flushing’s mom-and-pop businesses. </p>";

let divText5 = 
  "<p>Let’s first see how many new restaurants have opened in Flushing over recent years. </p>";

  let divText500 = `
  <p>
    The overall pace of  <span style="border:1.6px solid black; border-radius:2px; padding:2px 4px; display:inline-block;">new restaurant openings</span> has slowed, indicating a shrinking market.
  </p>
`;



let divText501 =
  "<p>Despite a slight yearly decline in new restaurant openings, <span class='highlightred'>Chain Restaurants</span> have steadily expanded their footprint, taking up a larger share of a shrinking market. </p>";

let divText502 = `
  <p>
    The <span style="border-bottom: 2px solid #0060e6; padding-bottom: 1.5px;">Proportion of Chain Restaurants</span> among new openings in Downtown Flushing has been steadily increasing.
  </p>
`;


let divText503 =
  "<p>In just one year, the proportion of chain restaurant openings in Downtown Flushing has increased by <span class='highlightred'>11.8</span> percentage points — and by <span class='highlightred'>21.8</span> points over two years, reflecting a sharp acceleration in chain expansion across the area.</p>";

let divChapter4 =
  "<h3 style='max-width:600px; margin-left:auto; margin-right:auto'> </h3>" +
  "<p style='max-width:600px; margin: 8em auto 2em auto;'>Over the past two years, Chinese chain restaurants have weathered the slowdown and gradually strengthened their position in the local market.</p>" +
  "<p style='max-width:600px; margin: 2em auto 2em auto;font-weight: bold; font-size: 2.18em;'>Downtown Flushing’s chain expansion becomes even more striking when compared to trends in other New York City neighborhoods.</p>" +
  "<p style='max-width:600px; margin: 3em auto 4em auto;'>The following charts compare the chain restaurant opening ratios across several key neighborhoods.</p>" +
  '<img src="images/Comparison.png" style="width:70%; margin: 1em auto; display: block;">' +
  "<p style='max-width:600px; margin: 3em auto 4em auto;'>Compared to other neighborhoods, Downtown Flushing was the only area to experience a substantial increase in the share of chain restaurant openings in 2025, while most others saw a decline.</p>" +
  "<p style='max-width:600px; margin: 3em auto 4em auto;'>This divergence signals a uniquely intensified commercial transformation.</p>" +
  "<p style='max-width:600px; margin: 3em auto 8em auto;'>This surge in chain restaurant openings hasn’t occurred in a vacuum. It has come at a cost — pushing out many small, independent businesses that once anchored Flushing’s street life and cultural identity.</p>" 
 

let divText6 =
  "<p>Many small businesses struggled with rising rents, leading to widespread closures, including Malu Hot Pot in 2024, Daxi Szechuan Cuisine in 2024, and Yogurt House in 2025. </p>";

let divTextPrinceA = `
  <p>Among the areas most affected by this shift is 
    <span style="font-weight: bold; border-bottom: 2px solid#000000; padding-bottom: 1.5px;">Prince Street</span>.</p>
`;

let divTextPrince0 = `
  <p><span style="font-weight: bold; border-bottom: 2px solid#000000; padding-bottom: 1.5px;">Prince Street</span> was once a vibrant hub of small, independent businesses in Downtown Flushing.</p>
`;

let divTextPrince1 =
  "<p>Lined with family-owned shops, bakeries, and local eateries, Prince Street historically embodied the neighborhood’s immigrant-driven commercial fabric, with only a few establishments being <span style='border-bottom: 1.5px solid #0060e6; padding-bottom: 1px;'>chains</span>.</p>" +
  '<img src="images/before.png" style="width:100%; margin: 1em auto; display: block;">' +
  '<p class="imageCredit"><a href="https://maps.app.goo.gl/y5bc2JxCjhiBdscG8">Google Street Views</a> in 2017.</p>';


let divTextPrince2 =
  "<p>A look at Prince Street in 2017.</p>" +
  '<iframe src="https://www.google.com/maps/embed?pb=!4v1746033311713!6m8!1m7!1sABhZxeTl2exl-8BoygmUYw!2m2!1d40.76045905464202!2d-73.83278903456517!3f130.91242524192847!4f-1.0783516043983497!5f0.7820865974627469" ' +
  'style="width:100%; height:450px; border:0; margin: 1em 0; display: block;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>';


let divTextPrince3 =
  "<p>However, luxury development and outside investment have displaced small businesses on Prince Street, disrupting its local culture and food scene. </p>";

let divTextPrince4 =
  "<p>Tangram, a major luxury development completed in 2021, introduced upscale dining, global retail chains, and high-end residences to Prince Street—accelerating the displacement of small, immigrant-owned businesses that once defined the area.</p>" +
  '<img src="images/tangram1.png" style="width:100%; margin: 1em auto; display: block;">' +
  '<p class="imageCredit"><a href="https://retail.tangramnyc.com/">Tangram</a></p>';


let divTextPrince5 =
  "<p>Online reactions reflect a broader frustration—many see Tangram as catering to wealthier outsiders, out of touch with the local community. </p>" +
  '<img src="images/comment.png" style="width:100%; margin: 1em auto; display: block;">';

//------------------------------------具体案例对比滑动------------------------
let divTextPrince6 = `
  <p>This area was once lined with immigrant-run restaurants and shops. Since the opening of Tangram, many have been displaced by chains and branded bubble tea stores.</p>
  <div class="clip-compare">
    <img src="images/Hey2024.png" class="clip-img before" alt="Before">
    <img src="images/Hey2021.png" class="clip-img after" alt="After">
    <input type="range" class="clip-slider" min="0" max="100" value="50">
  </div> +
`;


let divTextPrince7 = 
  "<p>Today, most of the long-standing businesses on Prince Street have <span style='border-bottom: 1.5px solid #000000; padding-bottom: 1px;'>closed</span>.</p>";


let divTextPrince8 =
  "<p>In their place, chain restaurants, upscale dining spots, and branded bubble tea shops have taken root—eroding the cultural and economic diversity that once defined Prince Street.</p>" +
  '<img src="images/after.png" style="width:100%; margin: 1em auto; display: block;">' +
  '<p class="imageCredit"><a href="https://maps.app.goo.gl/y5bc2JxCjhiBdscG8">Google Street Views</a> in 2024.</p>';

let divTextPrince9 =
  "<p>Prince Street’s transformation is not just a local story—it’s a reflection of wider pressures reshaping ethnic enclaves across New York.</p>";

let divTextPrince10 =
  "<p>Across New York’s immigrant enclaves, small business corridors are being reconfigured by luxury development and transnational capital. The shift is subtle but accumulative, chipping away at the spaces where working-class life once found visibility, ownership, and voice.</p>";

let divTextPrince11 =
  "<p> </p>";

let divChapter12 =
  "<p style='max-width:600px; margin: 8em auto 2em auto;'>Across New York’s immigrant enclaves, small business corridors are being reconfigured by luxury development and transnational capital. </p>" +
  '<img src="images/Ending.png" style="width:44%; margin: 1em auto; display: block;">' +
  "<p style='max-width:600px; margin: -0.4em auto 3em auto; font-size: 1.3em;'>Manhattan Chinatown, under the same pressures.</p>"  +
  "<p style='max-width:600px; margin: 3em auto 2em auto;'>The shift is subtle but accumulative, chipping away at the spaces where working-class life once found visibility, ownership, and voice—</p>" +
  "<p style='max-width:600px; margin: 3em auto 8em auto;'>and if the shift is inevitable, where do we go from here?</p>" 
 



var config = {
  style: "mapbox://styles/juanfrans/cm6jjlhqn00wx01qm0ez1hond",
  // leave commented to use Mapbox Standard Style
  accessToken: "*****ADD ACCESS TOKEN*****",
  showMarkers: false,
  markerColor: "#3FB1CE",
  //projection: 'equirectangular',
  //Read more about available projections here
  //https://docs.mapbox.com/mapbox-gl-js/example/projections/
  inset: false,
  insetOptions: {
    markerColor: "orange",
  },
  insetPosition: "bottom-right",
  theme: "light",
  use3dTerrain: false, //set true for enabling 3D maps.
  auto: false,
  topTitle: topTitleDiv,
  title: titleDiv,
  subtitle: "",
  byline: bylineDiv,
  description: descriptionDiv,
  footer: footerDiv,
  chapters: [
    {

      // ----------------------------------------进入地图-----------------------------------------
      id: "overallMap0",
      alignment: "center",
      hidden: true,
      chapterDiv: "divText0_1",
      location: {
        center: [-73.945, 40.765],
        zoom: 10.8,
        pitch: 0,
        bearing: 0,
        speed: 1,
        curve: 1.8,
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      callback: "",
      onChapterEnter: [
        { layer: "new-restaurant-layer", opacity: 0 },
        { layer: "highend-restaurant-layer", opacity: 0 },
        { layer: "rising-proportion-layer", opacity: 0 },
        { layer: "comparison-layer", opacity: 0 },
        { layer: "Smallbusiness_Data", opacity: 0, duration: 500 },
        { layer: "Chain_Data", opacity: 0, duration: 500 },
        { layer: "All_Data", opacity: 0, duration: 500 },
        //{ layer: "Chain_Influence_Data", opacity: 0, duration: 500 },
        { layer: "Downtown_Flushing", opacity: 0, duration: 500 }
      ],
      onChapterExit: [],
    },
    
    {
      id: "overallMap0_1",
      alignment: "center",
      hidden: true,
      chapterDiv: "divText0_1",
      location: {
        center: [-73.915, 40.765],
        zoom: 11.5,
        pitch: 0,
        bearing: 0,
        speed: 1,
        curve: 1.8
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      callback: "",
      onChapterEnter: [
        { layer: "new-restaurant-layer", opacity: 0 },
        { layer: "highend-restaurant-layer", opacity: 0 },
        { layer: "rising-proportion-layer", opacity: 0 },
        { layer: "All_Data", opacity: 0, duration: 500 },
        //{ layer: "Chain_Influence_Data", opacity: 0, duration: 500 },
        { layer: "princeA-layer", opacity: 0 },
        { layer: "prince0-layer", opacity: 0 },
        { layer: "prince1-layer", opacity: 0 },
        { layer: "prince2-layer", opacity: 0 },
        { layer: "prince3-layer", opacity: 0 },
        { layer: "prince4-layer", opacity: 0 },
        { layer: "prince5-layer", opacity: 0 },
        { layer: "prince6-layer", opacity: 0 },
        { layer: "prince7-layer", opacity: 0 },
        { layer: "prince8-layer", opacity: 0 },
        { layer: "prince9-layer", opacity: 0 },
        { layer: "comparison-layer", opacity: 0 }
      ],
      onChapterExit: [],
    },
    
    {
      id: "overallMap0_2",
      alignment: "center",
      hidden: true,
      chapterDiv: "divText0_2",
      location: {
        center: [-73.875, 40.765],
        zoom: 12.25,
        pitch: 0,
        bearing: 0,
        speed: 1,
        curve: 1.8
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      callback: "",
      onChapterEnter: [
        { layer: "new-restaurant-layer", opacity: 0 },
        { layer: "highend-restaurant-layer", opacity: 0 },
        { layer: "rising-proportion-layer", opacity: 0 },
        { layer: "All_Data", opacity: 0, duration: 500 },
        //{ layer: "Chain_Influence_Data", opacity: 0, duration: 500 },
        { layer: "princeA-layer", opacity: 0 },
        { layer: "prince0-layer", opacity: 0 },
        { layer: "prince1-layer", opacity: 0 },
        { layer: "prince2-layer", opacity: 0 },
        { layer: "prince3-layer", opacity: 0 },
        { layer: "prince4-layer", opacity: 0 },
        { layer: "prince5-layer", opacity: 0 },
        { layer: "prince6-layer", opacity: 0 },
        { layer: "prince7-layer", opacity: 0 },
        { layer: "prince8-layer", opacity: 0 },
        { layer: "prince9-layer", opacity: 0 },
        { layer: "comparison-layer", opacity: 0 }
      ],
      onChapterExit: [],
    },


    
    

    // -------------------------------------开始展示餐厅数据------------------------------------------
    {
      id: "overallMap1",
      alignment: "left",
      hidden: false,
      chapterDiv: divText1,
      location: {
        center: [-73.837, 40.760],
        zoom: 15.3,
        pitch: 0,
        bearing: 0,
        speed: 0.01,
        curve: 1.8
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      callback: "",
      onChapterEnter: [
        { layer: "new-restaurant-layer", opacity: 0 },
        { layer: "highend-restaurant-layer", opacity: 0 },
        { layer: "rising-proportion-layer", opacity: 0 },
        { layer: "comparison-layer", opacity: 0 },
        { layer: "Smallbusiness_Data", opacity: 0, duration: 500 },
        { layer: "Chain_Data", opacity: 0, duration: 500 },
        { layer: "All_Data", opacity: 1, duration: 500 },
        { layer: "princeA-layer", opacity: 0 },
        { layer: "prince0-layer", opacity: 0 },
        { layer: "prince1-layer", opacity: 0 },
        { layer: "prince2-layer", opacity: 0 },
        { layer: "prince3-layer", opacity: 0 },
        { layer: "prince4-layer", opacity: 0 },
        { layer: "prince5-layer", opacity: 0 },
        { layer: "prince6-layer", opacity: 0 },
        { layer: "prince7-layer", opacity: 0 },
        { layer: "prince8-layer", opacity: 0 },
        { layer: "prince9-layer", opacity: 0 },        
        //{ layer: "Chain_Influence_Data", opacity: 0, duration: 500 },
        { layer: "Downtown_Flushing", opacity: 0, duration: 500 }
      ],
      onChapterExit: [],
    },
    
    {
      id: "overallMap2",
      alignment: "left",
      hidden: false,
      chapterDiv: divText2,
      location: {
        center: [-73.837, 40.760],
        zoom: 15.3,
        pitch: 0,
        bearing: 0,
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      callback: "",
      onChapterEnter: [
        { layer: "new-restaurant-layer", opacity: 0 },
        { layer: "highend-restaurant-layer", opacity: 0 },
        { layer: "rising-proportion-layer", opacity: 0 },
        { layer: "comparison-layer", opacity: 0 },
        { layer: "basechart-layer", opacity: 0 },
        { layer: "Smallbusiness_Data", opacity: 1, duration: 500 },
        { layer: "Chain_Data", opacity: 0, duration: 500 },
        { layer: "All_Data", opacity: 0, duration: 500 },
        { layer: "princeA-layer", opacity: 0 },
        { layer: "prince0-layer", opacity: 0 },
        { layer: "prince1-layer", opacity: 0 },
        { layer: "prince2-layer", opacity: 0 },
        { layer: "prince3-layer", opacity: 0 },
        { layer: "prince4-layer", opacity: 0 },
        { layer: "prince5-layer", opacity: 0 },
        { layer: "prince6-layer", opacity: 0 },
        { layer: "prince7-layer", opacity: 0 },
        { layer: "prince8-layer", opacity: 0 },
        { layer: "prince9-layer", opacity: 0 },
        //{ layer: "Chain_Influence_Data", opacity: 0, duration: 500 },
        { layer: "Downtown_Flushing", opacity: 0, duration: 500 }
      ],
      onChapterExit: [],
    },
    
    {
      id: "overallMap3",
      alignment: "left",
      hidden: false,
      chapterDiv: divText3,
      location: {
        center: [-73.837, 40.760],
        zoom: 15.3,
        pitch: 0,
        bearing: 0,
        speed: 0.01,
        curve: 5
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      callback: "",
      onChapterEnter: [
        { layer: "new-restaurant-layer", opacity: 0 },
        { layer: "highend-restaurant-layer", opacity: 0 },
        { layer: "rising-proportion-layer", opacity: 0 },
        { layer: "comparison-layer", opacity: 0 },
        { layer: "basechart-layer", opacity: 0 },
        { layer: "Smallbusiness_Data", opacity: 1, duration: 500 },
        { layer: "Chain_Data", opacity: 1, duration: 500 },
        { layer: "All_Data", opacity: 0, duration: 500 },
        //{ layer: "Chain_Influence_Data", opacity: 0, duration: 500 },
        { layer: "Downtown_Flushing", opacity: 0, duration: 500 }
      ],
      onChapterExit: [],
    },

    {
      id: "overallMap4",
      alignment: "left",
      hidden: false,
      chapterDiv: divText4,
      location: {
        center: [-73.837, 40.760],
        zoom: 15.3,
        pitch: 0,
        bearing: 0,
        speed: 0.01,
        curve: 5
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      callback: "",
      onChapterEnter: [
        { layer: "new-restaurant-layer", opacity: 0 },
        { layer: "highend-restaurant-layer", opacity: 0 },
        { layer: "rising-proportion-layer", opacity: 0 },
        { layer: "comparison-layer", opacity: 0 },
        { layer: "basechart-layer", opacity: 0 },
        { layer: "Smallbusiness_Data", opacity: 1, duration: 500 },
        { layer: "Chain_Data", opacity: 1, duration: 500 },
        { layer: "All_Data", opacity: 0, duration: 500 },
        { layer: "princeA-layer", opacity: 0 },
        { layer: "prince0-layer", opacity: 0 },
        { layer: "prince1-layer", opacity: 0 },
        { layer: "prince2-layer", opacity: 0 },
        { layer: "prince3-layer", opacity: 0 },
        { layer: "prince4-layer", opacity: 0 },
        { layer: "prince5-layer", opacity: 0 },
        { layer: "prince6-layer", opacity: 0 },
        { layer: "prince7-layer", opacity: 0 },
        { layer: "prince8-layer", opacity: 0 },
        { layer: "prince9-layer", opacity: 0 },
        //{ layer: "Chain_Influence_Data", opacity: 1, duration: 500 },
        { layer: "Downtown_Flushing", opacity: 0, duration: 500 }
      ],
      onChapterExit: [
        { layer: "Smallbusiness_Data", opacity: 0, duration: 500 },
        { layer: "Chain_Data", opacity: 0, duration: 500 },
        //{ layer: "Chain_Influence_Data", opacity: 0, duration: 500 },
        { layer: "All_Data", opacity: 0, duration: 500 }
      ],
    },

    {
    id: "overallMap401",
      alignment: "center",
      hidden: true,
      chapterDiv: "divText0_1",
      location: {
        center: [-73.837, 40.760],
        zoom: 15.3,
        pitch: 0,
        bearing: 0,
        speed: 1,
        curve: 1.8,
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      callback: "",
      onChapterEnter: [
        { layer: "new-restaurant-layer", opacity: 0 },
        { layer: "highend-restaurant-layer", opacity: 0 },
        { layer: "rising-proportion-layer", opacity: 0 },
        { layer: "comparison-layer", opacity: 0 },
        { layer: "basechart-layer", opacity: 0 },
        { layer: "Smallbusiness_Data", opacity: 0, duration: 500 },
        { layer: "Chain_Data", opacity: 0, duration: 500 },
        { layer: "All_Data", opacity: 0, duration: 500 },
        { layer: "princeA-layer", opacity: 0 },
        { layer: "prince0-layer", opacity: 0 },
        { layer: "prince1-layer", opacity: 0 },
        { layer: "prince2-layer", opacity: 0 },
        { layer: "prince3-layer", opacity: 0 },
        { layer: "prince4-layer", opacity: 0 },
        { layer: "prince5-layer", opacity: 0 },
        { layer: "prince6-layer", opacity: 0 },
        { layer: "prince7-layer", opacity: 0 },
        { layer: "prince8-layer", opacity: 0 },
        { layer: "prince9-layer", opacity: 0 },
        { layer: "Downtown_Flushing", opacity: 0, duration: 500 }
      ],
      onChapterExit: [],
    },


    // ---------------------------------------开始展示图表--------------------------------------
    {
      id: "overallMap5",
      alignment: "center",
      hidden: false,
      chapterDiv: divText5,
      location: {
        center: [-73.845, 40.765],
        zoom: 13.15,
        pitch: 0,
        bearing: 0,
        speed: 0.01,
        curve: 5
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      callback: "",
      onChapterEnter: [
        { layer: "new-restaurant-layer", opacity: 0 },
        { layer: "highend-restaurant-layer", opacity: 0 },
        { layer: "rising-proportion-layer", opacity: 0 },
        { layer: "comparison-layer", opacity: 0 },
        { layer: "basechart-layer", opacity: 1 },
        { layer: "princeA-layer", opacity: 0 },
        { layer: "prince0-layer", opacity: 0 },
        { layer: "prince1-layer", opacity: 0 },
        { layer: "prince2-layer", opacity: 0 },
        { layer: "prince3-layer", opacity: 0 },
        { layer: "prince4-layer", opacity: 0 },
        { layer: "prince5-layer", opacity: 0 },
        { layer: "prince6-layer", opacity: 0 },
        { layer: "prince7-layer", opacity: 0 },
        { layer: "prince8-layer", opacity: 0 },
        { layer: "prince9-layer", opacity: 0 },
        { layer: "new-restaurant-layer", opacity: 0 }
      ],
      onChapterExit: [
        { layer: "basechart-layer", opacity: 0 }
      ],
    },
    
    {
      id: "overallMap500",
      alignment: "center",
      hidden: false,
      chapterDiv: divText500,
      location: {
        center: [-73.845, 40.765],
        zoom: 13.15,
        pitch: 0,
        bearing: 0,
        speed: 0.01,
        curve: 5
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      callback: "",
      onChapterEnter: [
        { layer: "new-restaurant-layer", opacity: 1 },
        { layer: "highend-restaurant-layer", opacity: 0 },
        { layer: "rising-proportion-layer", opacity: 0 },
        { layer: "comparison-layer", opacity: 0 },
        { layer: "basechart-layer", opacity: 0 },
        { layer: "highend-restaurant-layer", opacity: 0 }
      ],
      onChapterExit: [
        { layer: "new-restaurant-layer", opacity: 0 }
      ],
    },

    {
      id: "overallMap501",
      alignment: "center",
      hidden: false,
      chapterDiv: divText501,
      location: {
        center: [-73.845, 40.765],
        zoom: 13.15,
        pitch: 0,
        bearing: 0,
        speed: 0.01,
        curve: 5
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      callback: "",
      onChapterEnter: [
        { layer: "new-restaurant-layer", opacity: 0 },
        { layer: "highend-restaurant-layer", opacity: 0 },
        { layer: "rising-proportion-layer", opacity: 0 },
        { layer: "comparison-layer", opacity: 0 },
        { layer: "basechart-layer", opacity: 0 },
        { layer: "princeA-layer", opacity: 0 },
        { layer: "prince0-layer", opacity: 0 },
        { layer: "prince1-layer", opacity: 0 },
        { layer: "prince2-layer", opacity: 0 },
        { layer: "prince3-layer", opacity: 0 },
        { layer: "prince4-layer", opacity: 0 },
        { layer: "prince5-layer", opacity: 0 },
        { layer: "prince6-layer", opacity: 0 },
        { layer: "prince7-layer", opacity: 0 },
        { layer: "prince8-layer", opacity: 0 },
        { layer: "prince9-layer", opacity: 0 },
        { layer: "highend-restaurant-layer", opacity: 1 }
      ],
      onChapterExit: [
        { layer: "highend-restaurant-layer", opacity: 0 }
      ],
    },
  
    {
      id: "overallMap502",
      alignment: "center",
      hidden: false,
      chapterDiv: divText502,
      location: {
        center: [-73.845, 40.765],
        zoom: 13.15,
        pitch: 0,
        bearing: 0,
        speed: 0.01,
        curve: 5
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      callback: "",
      onChapterEnter: [
        { layer: "new-restaurant-layer", opacity: 0 },
        { layer: "highend-restaurant-layer", opacity: 0 },
        { layer: "rising-proportion-layer", opacity: 0 },
        { layer: "comparison-layer", opacity: 0 },
        { layer: "basechart-layer", opacity: 0 },
        { layer: "rising-proportion-layer", opacity: 1 }
      ],
      onChapterExit: [
        { layer: "rising-proportion-layer", opacity: 0 }
      ],
    },
  
    {
      id: "overallMap503",
      alignment: "center",
      hidden: false,
      chapterDiv: divText503,
      location: {
        center: [-73.845, 40.765],
        zoom: 13.15,
        pitch: 0,
        bearing: 0,
        speed: 0.01,
        curve: 5
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      callback: "",
      onChapterEnter: [
        { layer: "new-restaurant-layer", opacity: 0 },
        { layer: "highend-restaurant-layer", opacity: 0 },
        { layer: "rising-proportion-layer", opacity: 0 },
        { layer: "comparison-layer", opacity: 0 },
        { layer: "basechart-layer", opacity: 0 },
        { layer: "princeA-layer", opacity: 0 },
        { layer: "prince0-layer", opacity: 0 },
        { layer: "prince1-layer", opacity: 0 },
        { layer: "prince2-layer", opacity: 0 },
        { layer: "prince3-layer", opacity: 0 },
        { layer: "prince4-layer", opacity: 0 },
        { layer: "prince5-layer", opacity: 0 },
        { layer: "prince6-layer", opacity: 0 },
        { layer: "prince7-layer", opacity: 0 },
        { layer: "prince8-layer", opacity: 0 },
        { layer: "prince9-layer", opacity: 0 },
        { layer: "comparison-layer", opacity: 1 }
      ],
      onChapterExit: [
        { layer: "comparison-layer", opacity: 0 }
      ],
    },





    

    // -------------------------------------展示图表结束，进入滚动文本------------------------------------ 
    {
      id: "weekdayTrips",
      alignment: "full",
      hidden: false,
      chapterDiv: divChapter4,
      location: {
        center: [-73.845, 40.765],
        zoom: 13.15,
        pitch: 0,
        bearing: 0
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      callback: "",
      onChapterEnter: [
        { layer: "new-restaurant-layer", opacity: 0 },
        { layer: "highend-restaurant-layer", opacity: 0 },
        { layer: "rising-proportion-layer", opacity: 0 },
        { layer: "princeA-layer", opacity: 0 },
        { layer: "prince0-layer", opacity: 0 },
        { layer: "prince1-layer", opacity: 0 },
        { layer: "prince2-layer", opacity: 0 },
        { layer: "prince3-layer", opacity: 0 },
        { layer: "prince4-layer", opacity: 0 },
        { layer: "prince5-layer", opacity: 0 },
        { layer: "prince6-layer", opacity: 0 },
        { layer: "prince7-layer", opacity: 0 },
        { layer: "prince8-layer", opacity: 0 },
        { layer: "prince9-layer", opacity: 0 },
        { layer: "comparison-layer", opacity: 0 }
      ],
      onChapterExit: [],
    },
  

    // -------------------------------------回到地图，zoom展示具体案例-------------------------------
    {
      id: "overallMap6",
      alignment: "center",
      hidden: false,
      chapterDiv: divText6,
      location: {
        center: [-73.8367, 40.760],
        zoom: 15.4,
        pitch: 0,
        bearing: 0,
        speed: 0.01,
        curve: 5
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      callback: "",
      onChapterEnter: [
        { layer: "new-restaurant-layer", opacity: 0 },
        { layer: "highend-restaurant-layer", opacity: 0 },
        { layer: "rising-proportion-layer", opacity: 0 },
        { layer: "comparison-layer", opacity: 0 },
        { layer: "Smallbusiness_Data", opacity: 0, duration: 500 },
        { layer: "princeA-layer", opacity: 0 },
        { layer: "prince0-layer", opacity: 0 },
        { layer: "prince1-layer", opacity: 0 },
        { layer: "prince2-layer", opacity: 0 },
        { layer: "prince3-layer", opacity: 0 },
        { layer: "prince4-layer", opacity: 0 },
        { layer: "prince5-layer", opacity: 0 },
        { layer: "prince6-layer", opacity: 0 },
        { layer: "prince7-layer", opacity: 0 },
        { layer: "prince8-layer", opacity: 0 },
        { layer: "prince9-layer", opacity: 0 }, 
        { layer: "Chain_Data", opacity: 0, duration: 500 }
      ],
      onChapterExit: [
        { layer: "Smallbusiness_Data", opacity: 0, duration: 500 },
        { layer: "Chain_Data", opacity: 0, duration: 500 }
      ],
    },
  

//-------------------------------------------------PRINCE---------------------------------------------
    //-----Prince Street白底
    {
      id: "Prince0A",
      alignment: "left",
      hidden: false,
      chapterDiv: divTextPrinceA,
      location: {
        center: [-73.8367, 40.760],
        zoom: 15.4,
        pitch: 0,
        bearing: 0,
        speed: 0.01
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      extraClasses: ["step-dark"],
      callback: "",
      onChapterEnter: [
        { layer: "new-restaurant-layer", opacity: 0 },
        { layer: "highend-restaurant-layer", opacity: 0 },
        { layer: "rising-proportion-layer", opacity: 0 },
        { layer: "comparison-layer", opacity: 0 },
        { layer: "princeA-layer", opacity: 1 },
        { layer: "prince0-layer", opacity: 0 },
        { layer: "prince1-layer", opacity: 0 },
        { layer: "prince2-layer", opacity: 0 },
        { layer: "prince3-layer", opacity: 0 },
        { layer: "prince4-layer", opacity: 0 },
        { layer: "prince5-layer", opacity: 0 },
        { layer: "prince6-layer", opacity: 0 },
        { layer: "prince7-layer", opacity: 0 },
        { layer: "prince8-layer", opacity: 0 },
        { layer: "prince9-layer", opacity: 0 }, 
        { layer: "Downtown_Flushing", opacity: 0, duration: 500 }
      ],
      onChapterExit: [
        { layer: "princeA-layer", opacity: 0, duration: 0 }
      ],
      
    },
    //-----Prince Street黑底
    {
      id: "Prince00",
      alignment: "left",
      hidden: false,
      chapterDiv: divTextPrince0,
      location: {
        center: [-73.8336, 40.75955],
        zoom: 17.35,
        pitch: 0,
        bearing: -22.6,
        speed: 0.01
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      extraClasses: ["step-dark"],
      callback: "",
      onChapterEnter: [
        { layer: "new-restaurant-layer", opacity: 0 },
        { layer: "highend-restaurant-layer", opacity: 0 },
        { layer: "rising-proportion-layer", opacity: 0 },
        { layer: "comparison-layer", opacity: 0 },
        { layer: "princeA-layer", opacity: 0 },
        { layer: "prince0-layer", opacity: 1 },
        { layer: "prince1-layer", opacity: 0 },
        { layer: "prince2-layer", opacity: 0 },
        { layer: "prince3-layer", opacity: 0 },
        { layer: "prince4-layer", opacity: 0 },
        { layer: "prince5-layer", opacity: 0 },
        { layer: "prince6-layer", opacity: 0 },
        { layer: "prince7-layer", opacity: 0 },
        { layer: "prince8-layer", opacity: 0 },
        { layer: "prince9-layer", opacity: 0 }, 
        { layer: "Downtown_Flushing", opacity: 0, duration: 500 }
      ],
      onChapterExit: [],
    },
    //-----Prince Street2017
    {
      id: "Prince01",
      alignment: "left",
      hidden: false,
      chapterDiv: divTextPrince1,
      location: {
        center: [-73.8336, 40.75955],
        zoom: 17.35,
        pitch: 0,
        bearing: -22.6
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      extraClasses: ["step-dark"],
      callback: "",
      onChapterEnter: [
        { layer: "new-restaurant-layer", opacity: 0 },
        { layer: "highend-restaurant-layer", opacity: 0 },
        { layer: "rising-proportion-layer", opacity: 0 },
        { layer: "comparison-layer", opacity: 0 },
        { layer: "princeA-layer", opacity: 0 },
        { layer: "prince0-layer", opacity: 0 },
        { layer: "prince1-layer", opacity: 1 },
        { layer: "prince2-layer", opacity: 0 },
        { layer: "prince3-layer", opacity: 0 },
        { layer: "prince4-layer", opacity: 0 },
        { layer: "prince5-layer", opacity: 0 },
        { layer: "prince6-layer", opacity: 0 },
        { layer: "prince7-layer", opacity: 0 },
        { layer: "prince8-layer", opacity: 0 },
        { layer: "prince9-layer", opacity: 0 }, 
        { layer: "Downtown_Flushing", opacity: 0, duration: 500 }
      ],
      onChapterExit: [],
    },
    {
      id: "Prince02",
      alignment: "left", //----------A look at Prince Street in 2017
      hidden: false,
      chapterDiv: divTextPrince2,
      location: {
        center: [-73.8336, 40.75955],
        zoom: 17.35,
        pitch: 0,
        bearing: -22.6
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      extraClasses: ["step-dark"],
      callback: "",
      onChapterEnter: [
        { layer: "new-restaurant-layer", opacity: 0 },
        { layer: "highend-restaurant-layer", opacity: 0 },
        { layer: "rising-proportion-layer", opacity: 0 },
        { layer: "comparison-layer", opacity: 0 },
        { layer: "princeA-layer", opacity: 0 },
        { layer: "prince0-layer", opacity: 0 },
        { layer: "prince1-layer", opacity: 0 },
        { layer: "prince2-layer", opacity: 1 },
        { layer: "prince3-layer", opacity: 0 },
        { layer: "prince4-layer", opacity: 0 },
        { layer: "prince5-layer", opacity: 0 },
        { layer: "prince6-layer", opacity: 0 },
        { layer: "prince7-layer", opacity: 0 },
        { layer: "prince8-layer", opacity: 0 },
        { layer: "prince9-layer", opacity: 0 },    
        { layer: "Downtown_Flushing", opacity: 0, duration: 500 }
      ],
      onChapterExit: [],
    },
    //-----------------------------------------------------------------------------------------------
    //-----Tangram
    {
      id: "Prince03",
      alignment: "left",
      hidden: false,
      chapterDiv: divTextPrince3,  
      location: {
        center: [-73.8336, 40.75955],
        zoom: 17.35,
        pitch: 0,
        bearing: -22.6
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      extraClasses: ["step-dark"],
      callback: "",
      onChapterEnter: [
        { layer: "new-restaurant-layer", opacity: 0 },
        { layer: "highend-restaurant-layer", opacity: 0 },
        { layer: "rising-proportion-layer", opacity: 0 },
        { layer: "comparison-layer", opacity: 0 },
        { layer: "princeA-layer", opacity: 0 },
        { layer: "prince0-layer", opacity: 0 },
        { layer: "prince1-layer", opacity: 0 },
        { layer: "prince2-layer", opacity: 0 },
        { layer: "prince3-layer", opacity: 1 },
        { layer: "prince4-layer", opacity: 0 },
        { layer: "prince5-layer", opacity: 0 },
        { layer: "prince6-layer", opacity: 0 },
        { layer: "prince7-layer", opacity: 0 },
        { layer: "prince8-layer", opacity: 0 },
        { layer: "prince9-layer", opacity: 0 },        
        { layer: "Downtown_Flushing", opacity: 0, duration: 500 }
      ],
      onChapterExit: [],
    },
    {
      id: "Prince04",
      alignment: "left",
      hidden: false,
      chapterDiv: divTextPrince4,
      location: {
        center: [-73.8336, 40.75955],
        zoom: 17.35,
        pitch: 0,
        bearing: -22.6
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      extraClasses: ["step-dark"],
      callback: "",
      onChapterEnter: [
        { layer: "new-restaurant-layer", opacity: 0 },
        { layer: "highend-restaurant-layer", opacity: 0 },
        { layer: "rising-proportion-layer", opacity: 0 },
        { layer: "comparison-layer", opacity: 0 },
        { layer: "princeA-layer", opacity: 0 },
        { layer: "prince0-layer", opacity: 0 },
        { layer: "prince1-layer", opacity: 0 },
        { layer: "prince2-layer", opacity: 0 },
        { layer: "prince3-layer", opacity: 0 },
        { layer: "prince4-layer", opacity: 1 },
        { layer: "prince5-layer", opacity: 0 },
        { layer: "prince6-layer", opacity: 0 },
        { layer: "prince7-layer", opacity: 0 },
        { layer: "prince8-layer", opacity: 0 },
        { layer: "prince9-layer", opacity: 0 }, 
        { layer: "Downtown_Flushing", opacity: 0, duration: 500 }
      ],
      onChapterExit: [],
    },
    {
      id: "Prince05",
      alignment: "left",
      hidden: false,
      chapterDiv: divTextPrince5,
      location: {
        center: [-73.8336, 40.75955],
        zoom: 17.35,
        pitch: 0,
        bearing: -22.6
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      extraClasses: ["step-dark"],
      callback: "",
      onChapterEnter: [
        { layer: "new-restaurant-layer", opacity: 0 },
        { layer: "highend-restaurant-layer", opacity: 0 },
        { layer: "rising-proportion-layer", opacity: 0 },
        { layer: "comparison-layer", opacity: 0 },
        { layer: "princeA-layer", opacity: 0 },
        { layer: "prince0-layer", opacity: 0 },
        { layer: "prince1-layer", opacity: 0 },
        { layer: "prince2-layer", opacity: 0 },
        { layer: "prince3-layer", opacity: 0 },
        { layer: "prince4-layer", opacity: 1 },
        { layer: "prince5-layer", opacity: 0 },
        { layer: "prince6-layer", opacity: 0 },
        { layer: "prince7-layer", opacity: 0 },
        { layer: "prince8-layer", opacity: 0 },
        { layer: "prince9-layer", opacity: 0 }, 
        { layer: "Downtown_Flushing", opacity: 0, duration: 500 }
      ],
      onChapterExit: [],
    },
    {
      id: "Prince06",//------------图片是5
      alignment: "left",
      hidden: false,
      chapterDiv: divTextPrince6,
      location: {
        center: [-73.8336, 40.75955],
        zoom: 17.35,
        pitch: 0,
        bearing: -22.6
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      extraClasses: ["step-dark"],
      callback: "setupImageComparisonSlide",
      onChapterEnter: [
        { layer: "new-restaurant-layer", opacity: 0 },
        { layer: "highend-restaurant-layer", opacity: 0 },
        { layer: "rising-proportion-layer", opacity: 0 },
        { layer: "comparison-layer", opacity: 0 },
        { layer: "princeA-layer", opacity: 0 },
        { layer: "prince0-layer", opacity: 0 },
        { layer: "prince1-layer", opacity: 0 },
        { layer: "prince2-layer", opacity: 0 },
        { layer: "prince3-layer", opacity: 0 },
        { layer: "prince4-layer", opacity: 0 },
        { layer: "prince5-layer", opacity: 1 },
        { layer: "prince6-layer", opacity: 0 },
        { layer: "prince7-layer", opacity: 0 },
        { layer: "prince8-layer", opacity: 0 },
        { layer: "prince9-layer", opacity: 0 }, 
        { layer: "Downtown_Flushing", opacity: 0, duration: 500 }
      ],
      onChapterExit: [],
    },
    {
      id: "Prince07",
      alignment: "left",
      hidden: false,
      chapterDiv: divTextPrince7,
      location: {
        center: [-73.8336, 40.75955],
        zoom: 17.35,
        pitch: 0,
        bearing: -22.6
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      extraClasses: ["step-dark"],
      callback: "",
      onChapterEnter: [
        { layer: "new-restaurant-layer", opacity: 0 },
        { layer: "highend-restaurant-layer", opacity: 0 },
        { layer: "rising-proportion-layer", opacity: 0 },
        { layer: "comparison-layer", opacity: 0 },
        { layer: "princeA-layer", opacity: 0 },
        { layer: "prince0-layer", opacity: 0 },
        { layer: "prince1-layer", opacity: 0 },
        { layer: "prince2-layer", opacity: 0 },
        { layer: "prince3-layer", opacity: 0 },
        { layer: "prince4-layer", opacity: 0 },
        { layer: "prince5-layer", opacity: 0 },
        { layer: "prince6-layer", opacity: 1 },
        { layer: "prince7-layer", opacity: 0 },
        { layer: "prince8-layer", opacity: 0 },
        { layer: "prince9-layer", opacity: 0 }, 
        { layer: "Downtown_Flushing", opacity: 0, duration: 500 }
      ],
      onChapterExit: [],
    },
    {
      id: "Prince08",
      alignment: "left",
      hidden: false,
      chapterDiv: divTextPrince8,
      location: {
        center: [-73.8336, 40.75955],
        zoom: 17.35,
        pitch: 0,
        bearing: -22.6
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      extraClasses: ["step-dark"],
      callback: "",
      onChapterEnter: [
        { layer: "new-restaurant-layer", opacity: 0 },
        { layer: "highend-restaurant-layer", opacity: 0 },
        { layer: "rising-proportion-layer", opacity: 0 },
        { layer: "comparison-layer", opacity: 0 },
        { layer: "princeA-layer", opacity: 0 },
        { layer: "prince0-layer", opacity: 0 },
        { layer: "prince1-layer", opacity: 0 },
        { layer: "prince2-layer", opacity: 0 },
        { layer: "prince3-layer", opacity: 0 },
        { layer: "prince4-layer", opacity: 0 },
        { layer: "prince5-layer", opacity: 0 },
        { layer: "prince6-layer", opacity: 0 },
        { layer: "prince7-layer", opacity: 1 },
        { layer: "prince8-layer", opacity: 0 },
        { layer: "prince9-layer", opacity: 0 }, 
        { layer: "Downtown_Flushing", opacity: 0, duration: 500 }
      ],
      onChapterExit: [],
    },
    {
      id: "Prince09",
      alignment: "left",
      hidden: false,
      chapterDiv: divTextPrince9,
      location: {
        center: [-73.8336, 40.75955],
        zoom: 17.35,
        pitch: 0,
        bearing: -22.6
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      extraClasses: ["step-dark"],
      callback: "",
      onChapterEnter: [
        { layer: "new-restaurant-layer", opacity: 0 },
        { layer: "highend-restaurant-layer", opacity: 0 },
        { layer: "rising-proportion-layer", opacity: 0 },
        { layer: "comparison-layer", opacity: 0 },
        { layer: "princeA-layer", opacity: 0 },
        { layer: "prince0-layer", opacity: 0 },
        { layer: "prince1-layer", opacity: 0 },
        { layer: "prince2-layer", opacity: 0 },
        { layer: "prince3-layer", opacity: 0 },
        { layer: "prince4-layer", opacity: 0 },
        { layer: "prince5-layer", opacity: 0 },
        { layer: "prince6-layer", opacity: 0 },
        { layer: "prince7-layer", opacity: 0 },
        { layer: "prince8-layer", opacity: 1 },
        { layer: "prince9-layer", opacity: 0 }, 
        { layer: "Downtown_Flushing", opacity: 0, duration: 500 }
      ],
      onChapterExit: [],
    },

    {
      id: "Ending",
      alignment: "full",
      hidden: false,
      chapterDiv: divChapter12,
      location: {
        center: [-73.8336, 40.75955],
        zoom: 17.35,
        pitch: 0,
        bearing: 0
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      extraClasses: ["step-ending"],
      callback: "",
      onChapterEnter: [
        { layer: "new-restaurant-layer", opacity: 0 },
        { layer: "highend-restaurant-layer", opacity: 0 },
        { layer: "rising-proportion-layer", opacity: 0 },
        { layer: "comparison-layer", opacity: 0 },
        { layer: "princeA-layer", opacity: 0 },
        { layer: "prince0-layer", opacity: 0 },
        { layer: "prince1-layer", opacity: 0 },
        { layer: "prince2-layer", opacity: 0 },
        { layer: "prince3-layer", opacity: 0 },
        { layer: "prince4-layer", opacity: 0 },
        { layer: "prince5-layer", opacity: 0 },
        { layer: "prince6-layer", opacity: 0 },
        { layer: "prince7-layer", opacity: 0 },
        { layer: "prince8-layer", opacity: 0 },
        { layer: "prince9-layer", opacity: 1 }, 
        { layer: "Downtown_Flushing", opacity: 0, duration: 500 }
      ],
      onChapterExit: [],
    },
  ],
};